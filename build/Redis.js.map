{"version":3,"sources":["../src/Redis.js"],"names":["Redis","opts","key","value","JSON","stringify","snappy","compressSync","buffer","setBuffer","json","Promise","resolve","reject","getBuffer","uncompressSync","asBuffer","uncompress","parse","IORedis"],"mappings":";;;;;;;;;;AAAA;;;;AACA;;;;;;;;;;;;;;IAEMA,K;;;AACF,mBAAYC,IAAZ,EAAkB;AAAA;;AAAA,6GACRA,IADQ;AAEjB;;;;;gGAEkBC,G,EAAKC,K;;;;;;AACpB,oCAAI,QAAOA,KAAP,yCAAOA,KAAP,MAAgB,QAApB,EAA8B;AAC1BA,4CAAQC,KAAKC,SAAL,CAAeF,KAAf,CAAR;AACH;;uCACkBG,iBAAOC,YAAP,CAAoBJ,KAApB,C;;;AAAfK,sC;iEACG,KAAKC,SAAL,CAAeP,GAAf,EAAoBM,MAApB,C;;;;;;;;;;;;;;;;;;oCAGEN,G,EAA2B;AAAA;;AAAA,4FAAJ,EAAI;AAAA,mCAApBQ,IAAoB;AAAA,gBAApBA,IAAoB,8BAAb,IAAa;;AACpC,mBAAO,IAAIC,OAAJ;AAAA,oFAAY,kBAAOC,OAAP,EAAgBC,MAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,2CAEQ,OAAKC,SAAL,CAAeZ,GAAf,CAFR;;AAAA;AAEPM,0CAFO;AAAA;AAAA,2CAGYF,iBAAOS,cAAP,CAAsBP,MAAtB,EAA8B,EAAEQ,UAAU,KAAZ,EAA9B,CAHZ;;AAAA;AAGPC,8CAHO;;;AAKX,wCAAIP,IAAJ,EAAU;AACNE,gDAAQR,KAAKc,KAAL,CAAWD,UAAX,CAAR;AACH,qCAFD,MAEO;AACHL,gDAAQK,UAAR;AACH;AATU;AAAA;;AAAA;AAAA;AAAA;;AAYXJ;;AAZW;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iBAAZ;;AAAA;AAAA;AAAA;AAAA,gBAAP;AAeH;;;;EA7BeM,iB;;kBAgCLnB,K","file":"Redis.js","sourcesContent":["import IORedis from \"ioredis\";\nimport snappy from \"snappy\";\n\nclass Redis extends IORedis {\n    constructor(opts) {\n        super(opts);\n    }\n\n    async setCompress (key, value) {\n        if (typeof value == \"object\") {\n            value = JSON.stringify(value);\n        }\n        let buffer = await snappy.compressSync(value);\n        return this.setBuffer(key, buffer);\n    }\n\n    getCompress (key, { json = true } = {}) {\n        return new Promise(async (resolve, reject) => {\n            try {\n                let buffer = await this.getBuffer(key);\n                let uncompress = await snappy.uncompressSync(buffer, { asBuffer: false });\n                \n                if (json) {\n                    resolve(JSON.parse(uncompress));\n                } else {\n                    resolve(uncompress);\n                }\n            }\n            catch (err) {\n                reject(err);\n            }\n        })\n    }\n}\n\nexport default Redis;"]}